<!DOCTYPE html>
<html>
<head>
  <script type="text/javascript" src="http://latex.codecogs.com/latexit.js"></script>
  <title></title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">-->
  <!--<meta name="viewport" content="width=device-width, initial-scale=1.0">-->
  <!--This one seems to work all the time, but really small on ipad-->
  <!--<meta name="viewport" content="initial-scale=0.4">-->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" media="all" href="theme/css/default.css">
  <link rel="stylesheet" media="only screen and (max-device-width: 480px)" href="theme/css/phone.css">
  <base target="_blank"> <!-- This amazingness opens all links in a new tab. -->
  <script data-main="js/slides" src="js/require-1.0.8.min.js"></script>
</head>
<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="logoslide nobackground">
    <article class="flexbox vcenter">
      <span><img src="images/douban_logo.png"></span>
    </article>
  </slide>

  <slide class="title-slide segue nobackground">
    <!--aside class="gdbar"><img src="images/google_developers_icon_128.png"></aside>
    <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
    </hgroup>
  </slide>

  <slide class="no3">
    <hgroup>
      <h2>Outline</h2>
    </hgroup>
    <article>
      <br>
      <p>Motivation</p><br>
      <p>A little history</p><br>
      <p>Concept/Terminology</p><br>
      <p>Paradigm</p>
      <br>
    </article>
  </slide>

  <slide class="no4">
    <hgroup>
      <h2>Outline</h2>
    </hgroup>
    <article>
      <br>
      <p><font color="green">Motivation</font></p><br>
      <p>A little history</p><br>
      <p>Concept/Terminology</p><br>
      <p>Paradigm</p>
      <br>
    </article>
  </slide>

  <slide class="no5">
    <hgroup>
      <h2>Where to start</h2>
    </hgroup>
    <article>
      <div>
        <p>A simple example</p>
        <p lang="latex">$$ d_{1} + d_{2} + d_{3} + d_{4} + d_{5} +  ... + d_{k-1} + d_{k} $$</p>
        <ul class="build fade">
          <li><font size="3">single cpu 2.0GHz | 0.5 ns | 4 pipelines</font></li>
          <li><font size="3">+ | C.float.add | 5 cycle</font></li>
          <li lang="latex">$$k \ | \ 2 \times 10^{8} adds \ | \  1s$$</li>
          <li><font size="3">datasize | 1TB | simple add | 12min</font></li>
        </ul>
      </div>
    </article>
  </slide>

  <slide class="no6">
    <hgroup>
      <h2>Real Case1</h2>
    </hgroup>
    <article>
      <div>
        <p lang="latex">$$ d_{1} + d_{2} + d_{3} + d_{4} + d_{5} + d_{6}  ... + d_{k-1} + d_{k} $$</p>
        <ul class="build fade">
          <li><font size="3">d | float array</font></li>
          <li><font size="3">+ | user-defined func | 2000 cycles</font></li>
          <li lang="latex">k \ | \  0.5 \times 10^{7} +s</li>
          <li><font size="3">datasize | 1TB | user-defined func | 8.5h</font></li>
        </ul>
      </div>
    </article>
  </slide>

  <slide class="no7">
    <hgroup>
      <h2>Real Case2</h2>
    </hgroup>
    <article>
      <div class="build fade">
        <p lang="latex">$$ d_{1} + d_{2} + d_{3} + d_{4} + d_{5} +  ... + d_{k-1} + d_{k} $$</p>
        <ul>
          <li lang="latex">$$+ \ | \  \cap \cup \ like \ op $$</li>
          <li><font size="3">memory explosion</font></li>
        </ul>
      </div>
    </article>
  </slide>

  <slide class="no8">
    <hgroup>
      <h2>Optimization always confuse</h2>
    </hgroup>
    <article>
      <ul>
        <li>optimization x parallel computing
          <ul class="build fade">
            <li><font size="3">efficiency makes qualitative | life is limit</font></li>
            <li><font size="3">distributed memory makes qualitative | enough dataset?</font></li>
            <li><font size="3">parallel computing make things happen</font></li>
          </ul>
        </li>
      </ul>
    </article>
  </slide>

  <slide class="no9">
    <hgroup>
      <h2>Outline</h2>
    </hgroup>
    <article>
      <br>
      <p>Motivation</p><br>
      <p><font color="green">A little history</font></p><br>
      <p>Concept/Terminology</p><br>
      <p>Paradigm</p>
      <br>
    </article>
  </slide>

  <slide class="no10">
    <aside class="note">
      <section>
        <ul>
          <li>
            <img src="images/a.png" class="reflect" alt="Description" title="Description">
            <img src="images/b.png" alt="Description" title="Description">
            <img src="images/c.png" alt="Description" title="Description">
          </li>
        </ul>
      </section>
    </aside>
    <hgroup>
      <h2>A little history</h2>
    </hgroup>
    <article>
      <ul>
        <li>line0
          <ul class="build fade">
            <li><font size="3">human being | neurons in brain</font></li>
          </ul>
        </li>
        <li>line1
          <ul class="build fade">
            <li><font size="3">1960's vector machine</font></li>
            <li><font size="3">1970's | SMP(Symmetric Multiprocessor) | 10- cpus</font></li>
            <li><font size="3">1980's-2000 NUMA/MPP(Massive Parallel Processing) | 100+ cpus</font></li>
          </ul>
        </li>
        <li>line2
          <ul  class="build fade">
            <li><font size="3">Intel | pipeline in core | multicore</font></li>
            <li><font size="3">2005-  hybrid system | accelerated system with GPU/MIC | 1000+ cpus | peak?</font></li>
            <li><font size="3">2007- flat tree etc | SC conf | DCN(hot research @MSR)</font></li>
          </ul>
        </li>
        <li>line3
          <ul  class="build fade">
            <li><font size="3">2000- google | commercial cluster | distributed systems to make use of servers | across the room | paxos</font></li>
            <li><font size="3">mapreduce | lots of computation frameworks</font></li>
            <li><font size="3">douban | single room | all connected</font></li>
          </ul>
        </li>
      </ul>
    </article>
  </slide>
  
  <slide class="no11">
    <hgroup>
      <h2>Outline</h2>
    </hgroup>
    <article>
      <br>
      <p>Motivation</p><br>
      <p>A little history</p><br>
      <p><font color="green">Concept/Terminology</font></p><br>
      <p>Paradigm</p>
      <br>
    </article>
  </slide>
  
  <slide class="no12">
    <hgroup>
      <h2>How</h2>
    </hgroup>
    <article>
      <div>
        <p>A simple example</p>
        <p lang="latex">$$ d_{1} + d_{2} + d_{3} + d_{4} + d_{5} +  ... + d_{k-1} + d_{k} $$</p>
        <ul class="build fade">
          <li><font size="3">suppose k a power of 2</font></li>
          <li><font size="3">Algorithms?</font></li>
          <li><font size="3">solution1: master node</font></li>
          <li><font size="3">solution2: binary tree | node(value) edge(communication)</font></li>
        </ul>
      </div>
    </article>
  </slide>
  
  <slide class="no13">
    <hgroup>
      <h2>Move on</h2>
    </hgroup>
    <article>
      <div>
        <p lang="latex">$$ d_{1} + d_{2} + d_{3} + d_{4} + d_{5} +  ... + d_{k-1} + d_{k} $$</p>
        <ul class="build fade">
          <li><font size="3">partition | map | data distribution | load balance</font></li>
          <li><font size="3">parallel calc | simultaneous</font><li>
          <li><font size="3">sync | communication</font><li>
          <li><font size="3">(all)reduce</font></li>
          <li><font size="3">bug?</font></li>
          <li><font size="3">consistency | small dataset to verify</font></li>
        </ul>
      </div>
    </article>
  </slide>

  <slide class="no14">
    <hgroup>
      <h2>Cost Model</h2>
    </hgroup>
    <article>
      <div>
        <p>Amdahl's law</p>
          <ul class="build fade">
            <li><font size="3">r | portion which can be parallelized</font><li>
            <li lang="latex">$$T(p) = (\frac{r}{p} + 1 - r) T(1)$$<li>
            <li lang="latex">$$r \rightarrow 1 \ | \ T(p) \rightarrow \frac{r}{p} \ | \ px(linear) \ | \ :)$$</li>
            <li lang="latex">$$r \rightarrow 0.5 \  | \ T(p) \rightarrow  (0.5 + \frac{0.5}{p}) T(1) \ | \ p \rightarrow \infty \ | \ 2x \ | \  :($$</li>
            <li><font size="3">r is important | critical path | data/procedure level</font></li>
            <li><font size="3">scalability | data | process unit | time</font></li>
            <li><font size="3">no communication cost | toooooo ideal</font></li>
          </ul>
      </div>
    </article>
  </slide>

 <slide class="no15">
    <hgroup>
      <h2>Cost Model (Cond)</h2>
    </hgroup>
    <article>
      <div>
        <p>A better model (calc_cost + comm_cost)</p>
          <ul class="build fade">
            <li><font size="3"></font><li>
            <li lang="latex">$$\alpha + M\beta \ | \   10^{-3}+M10^{-8} \ | \ simplest \ communication \ model$$</li>
            <li lang="latex">$$solution1 \ | \ \frac{T(1)}{p} + (\beta\frac{M}{p} + \alpha) (p - 1) \ | \ :($$</li>
            <li lang="latex">$$solution2 \ | \ \frac{T(1)}{p} + (\beta\frac{M}{p} + \alpha) (logp) \ | \ :)$$</li>
            <li lang="latex">$$general \ | \ pT(p) = C + C_{1}(p - 1) + C_{2} p (p - 1)$$</li>
            <li lang="latex">$$C \ is \ portion \ can \ be \ paralleld$$</li> 
            <li lang="latex">$$C_{1} \ is \ bandwidthsome \ cost$$</li>
            <li lang="latex">$$C_{2} \ is \ latancy$$</li>
            <li><font size="3">pack is important | 10MB is large message @douban(dpark) | reduce message cost(lantancy)</font></li>
            <li><font size="3">stagnation point | scalability ability</font></li>
          </ul>
      </div>
    </article>
  </slide>

  <slide class="no16">
    <hgroup>
      <h2>More of Scalability</h2>
    </hgroup>
    <article>
      <div>
        <p>different partition leads to different communication</p>
          <ul class="build fade">
            <li><font size="3">2D(trick concept) data | n x n grids | O(n*2) |  1D partition vs 2D partition</font></li>
            <li lang="latex">$$1D \ | \ O(np) \ | \ \frac{n^{2}}{Cnp} \Rightarrow n\  \sim \ cp \ | \ \frac{n^{2}}{p}=\frac{c^{2}p^{2}}{p} \ | \ c^{2}p$$</li>
            <li lang="latex">$$2D \ | \ O(\frac{n}{\sqrt{p}}p) \ | \ \frac{n^{2}}{Cn\sqrt{p}} \Rightarrow n\  \sim \ c\sqrt{p} \ | \ \frac{n^{2}}{p}=\frac{c^{2}p}{p} \ | \ c^{2}$$</li>
          </ul>
      </div>
    </article>
  </slide>

  <slide class="no17">
    <hgroup>
      <h2>Implementation</h2>
    </hgroup>
    <article>
     <div>
        <p>Still the simple example</p>
        <p lang="latex">$$ d_{1} + d_{2} + d_{3} + d_{4} + d_{5} +  ... + d_{k-1} + d_{k} $$</p>
        <ul class="build fade">
          <li><font size="3">fork,fork | map</font></li>
          <li><font size="3">SIMD(Single Instruction Multiple Data) | if(rank = ?) | calc</font></li>
          <li><font size="3">Send/Recv | communication</font></li>
          <li><font size="3">barrier | sync</font></li>
          <li><font size="3">y, we design a distributed framework | kiss</font></li>
          <li><font size="3">that's almost enough, trust me</font></li>
        </ul>
      </div>
    </article>
  </slide>

  <slide class="no18">
    <hgroup>
      <h2>Pairwise Summation (Solution1)</h2>
      <h3 lang="latex">$$ d_{1} + d_{2} + d_{3} + d_{4} + d_{5} +  ... + d_{k-1} + d_{k} $$</h3>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="c++">
  // This is a c++ pseudo code.
  type parallel_load(...) {...} 
  type sum_calc(data, comm) {...}
  <b>float reduce(sum, comm) {
    float tmp = 0.0, result = sum; int cnt = comm.Get_size() - 1;
    if(comm.Get_rank() == 0) { 
      while(cnt--) { kiss_Recv(tmp, from = ANY); result += tmp; } 
    } else { kiss_Send(sum, to = 0); }
    return result;
  }</b>
  int main(int argc, char *argv[]) {
    kiss_Init(...);
    auto data = parallel_load('a.txt', comm);
    auto local_sum = sum_calc(data);
    reduce(local_sum, comm); kiss_Finalize();
  }
</pre>
    </article>
  </slide>

  <slide class="19">
    <hgroup>
      <h2>Pairwise Summation (Solution2)</h2>
    </hgroup>
    <article>
      <iframe data-src="http://code.dapps.douban.com/wuhong/mpireduce/blob/master/src/treereduce.c"></iframe>
    </article>
  </slide>

  <slide class="no20">
    <hgroup>
      <h2>Outline</h2>
    </hgroup>
    <article>
      <br>
      <p>Motivation</p><br>
      <p>A little history</p><br>
      <p>Concept/Terminology</p><br>
      <p><font color="green">Paradigm</font></p>
      <br>
    </article>
  </slide>

  <slide class="no21">
    <hgroup>
      <h2>MPI/RPC</h2>
    </hgroup>
    <article>
     <div class="build fade">
        <p><font size="3">simple but low level | no algorithm level abstraction | gerneral</font></p>
        <p><font size="3">MPI_Init</font></p>
        <p><font size="3">MPI_Send/MPI_Recv</font></p>
        <p><font size="3">MPI_Barrier</font></p>
        <p><font size="3">MPI_Reduce(we already implement one | MPI_Bcast...</font></p>
        <p><font size="3">to programmers:</font></p>
        <p><font size="3">data distribution(partition + map)</font></p>
        <p><font size="3">calc</font></p>
        <p><font size="3">communication</font></p>
        <p><font size="3">sync</font></p>
      </div>
    </article>
  </slide>

  <slide class="no22">
    <aside class="note">
      <section>
        <ul>
          <li>Say<a href="http://openmp.org/wp/whos-using-openmp">'missing you'</a>to changsheng</li>
        </ul>
      </section>
    </aside>
    <hgroup>
      <h2>Openmp/Pthread</h2>
    </hgroup>
    <article>
     <div class="build fade">
        <p><font size="3">shared memory programming</font></p>
        <p><font size="3">openmp based on pthread</font></p>
        <p><font size="3">openmp used for compute-intensive forloop</font></p>
      </div>
    </article>
  </slide>

  <slide class="no23">
    <hgroup>
      <h2>Hybird MPI with Openmp</h2>
    </hgroup>
    <article class="build fade">
      <p><font size="3">multicore-servers clusters</font></p>
      <p><font size="3">linear speedup is waiting for you</font></p>
    </article>
  </slide>  

  <slide class="no24">
    <hgroup>
      <h2>MapReduce</h2>
    </hgroup>
    <article class="build fade">
      <p><font size="3">lisp | google | Jeff Dean</font></p>
      <p><font size="3">parallel 'map' and 'reduce' calc</font></p>
      <p><font size="3">structured communication(I/O stream)</font></p>
      <p><font size="3">middle level framework</font></p>
      <p><font size="3">mapreduce vs MPI:</font></p>
      <p><font size="3">'map'=linesplit + map</font></p>
      <p><font size="3">'reduce' = reduce</font></p>
      <p><font size="3">no shuffle in MPI | map in MPI is more difficult</font></p>
      <p><font size="3">easy deploy | pool locality | model transfer</font></p>
    </article>
  </slide> 

  <slide class="no25">
    <hgroup>
      <h2>MapReduce in Action</h2>
    </hgroup>
    <article class="smaller">
      <pre class="prettyprint" data-lang="python">
// wordcount with douban's mapreduce framework
delimiter = re.compile('[^-a-zA-Z0-9_]')

<b>def wc_map(line):
    return [(w, 1) for w in delimiter.split(line) if w]</b>

<b>def wc_reduce(a, b): 
    return int(a) + int(b)</b>

def sort_key(a):
    return a.split('\t', 1)[0]

def sort_kcmp(a, b): 
    return -cmp(int(a), int(b))

def sort_vcmp(a, b): 
    return -cmp(int(a.split('\t', 1)[0]), int(b.split('\t', 1)[0]))

def init(_):
    io.map_reduce(wc_map, wc_reduce, lambda w, c: c + "\t" + w)
    io.sort(sort_key, sort_kcmp, sort_vcmp)
</pre>
    </article>
  </slide>

  <slide class="no26">
    <hgroup>
      <h2>Spark/Dpark</h2>
    </hgroup>
    <article class="build fade">
      <p><font size="3">based on mesos | mesos is a better fork,fork(kiss)</font></p>
      <p><font size="3">memory cached | lineage to make fault-tolerant(hang on)</font></p>
      <p><font size="3">high level class</font></p>
      <p><font size="3">serial code style</font></p>
      <p><font size="3">to many apis</font></p>
      <p><font size="3">hard for wide dependency application</font></p>
    </article>
  </slide>

  <slide class="no27">
    <hgroup>
      <h2>Why Distributed Framework?</h2>
    </hgroup>
    <article class="build fade">
      <p><font size="3">easy code | stay focus on app</font></p>
      <p><font size="3">abstraction | code reuse</font></p>
      <p><font size="3">distributed computational ability</font></p>      
      <p><font size="3">great property from computing models</font></p>
    </article>
  </slide>

  <slide class="no28">
    <hgroup>
      <h2>More</h2>
    </hgroup>
    <article class="build fade">
      <p><font size="3">bsp</font></p>
      <p><font size="3">hadoop(mapreduce)</font></p>
      <p><font size="3">hama(pregel)</font></p>
      <p><font size="3">piccolo</font></p>
      <p><font size="3">parasol</font></p>
      <p><font size="3">graphlab</font></p>
      <p><font size="3">...</font></p>
    </article>
  </slide>

  <slide class="no29">
    <hgroup>
      <h2>Which one is better</h2>
    </hgroup>
    <article class="build fade">
      <p><font size="3">from low level to high level | implementation dependency</font></p>
      <p><font size="3">commercial cluster | GPU x | supercomputer x</font></p>
      <p><font size="3">mid-low level with simple api | general</font></p>
      <p><font size="3">glue | husband</font></p>
    </article>
  </slide>

  <slide class="no29">
    <hgroup>
      <h2>What we can do</h2>
    </hgroup>
    <article class="build fade">
      <p>discussion...</p>
    </article>
  </slide>

  <slide class="no30">
    <hgroup>
      <h2>Simple Summation Plus</h2>
    </hgroup>
    <article class="build fade">
      <p><font size="3">parallel is not obvious sometimes</font></p>
      <p><font size="3">fibonacci sequence | n-th | prefix</font></p>
      <p><font size="3">thinking...</font></p>
    </article>
  </slide>

  <slide class="no31">
    <hgroup>
      <h2>Simple Summation Plus (Cond)</h2>
    </hgroup>
    <article class="build fade">
      <p><font size="3">tree-reduce-like-process</font></p>
      <p><font size="3">segmented scan | [1 2 3 4 5 6 7 8 9 10] [1 0 0 0 10 1 10 1]: [1 3 6 10 5 11 7 8 17 10 ] </font></p>
      <p lang="latex">$$matrix \ inversion(Csanky) \ | \ A^{-1} = (A^{n-1} + c_{1}A^{n-2} + ... + c_{n-1}) / (-1/c_{n})$$</p>
      <p lang="latex">$$summator \ | \ a_{3}a_{2}a_{1}a_{0} + b_{3}b_{2}b_{1}b_{0}$$</p>
      <p><font size="3">fibonacci seqs</font></p>
      <p><font size="3">...</font></p>
      <p><font size="3">great | all recursion pattern algo | seq2parallel</font></p>
    </article>
  </slide>

  <slide class="no32">
    <hgroup>
      <h2>Summarize</h2>
    </hgroup>
    <article class="build fade">
      <p lang="latex">$$ d_{1} + d_{2} + d_{3} + d_{4} + d_{5} +  ... + d_{k-1} + d_{k} \ | \ a \ great \ example$$</p>
      <p><font size="3">optimization problems | + | iterater | serial</font></p>
      <p><font size="3">why (motivation)</font></p>     
      <p><font size="3">a little history</font></p>
      <p><font size="3">what (is parallel computing)</font></p>     
      <p><font size="3">How (kiss)</font></p>     
      <p><font size="3">what (is distributed framework)</font></p>
      <p><font size="3" color="green">seriesII (end of Oct): bsp, pregel (in action)</font></p>
      <p><font size="3" color="green">seriesIII (middle of Nov): parasol (how to build a demo distributed system)</font></p>
    </article>
  </slide>

  <slide class="thank-you-slide segue nobackground">
    <article class="flexbox vleft auto-fadein">
      <h2>Thank You!</h2>
      <p>contact info</p>
    </article>
    <p class="auto-fadein" data-config-contact>
      <!-- populated from slide_config.json -->
    </p>
  </slide>

  <slide class="logoslide dark nobackground">
    <article class="flexbox vcenter">
      <span><img src="images/douban_logo.png"></span>
    </article>
  </slide>

  <slide class="backdrop"></slide>

</slides>

<script>
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-XXXXXXXX-1']);
_gaq.push(['_trackPageview']);

(function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();
</script>

<!--[if IE]>
  <script src="http://ajax.googleapis.com/ajax/libs/chrome-frame/1/CFInstall.min.js"></script>
  <script>CFInstall.check({mode: 'overlay'});</script>
<![endif]-->
</body>
</html>
